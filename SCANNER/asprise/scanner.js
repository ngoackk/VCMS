var deployJava=function(){var l={core:["id","class","title","style"],i18n:["lang","dir"],events:["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onkeypress","onkeydown","onkeyup"],applet:["codebase","code","name","archive","object","width","height","alt","align","hspace","vspace"],object:["classid","codebase","codetype","data","type","archive","declare","standby","height","width","usemap","name","tabindex","align","border","hspace","vspace"]};var b=l.object.concat(l.core,l.i18n,l.events);var m=l.applet.concat(l.core);function g(o){if(!d.debug){return;}if(console.log){console.log(o);}else{alert(o);}}function k(p,o){if(p==null||p.length==0){return true;}var r=p.charAt(p.length-1);if(r!="+"&&r!="*"&&(p.indexOf("_")!=-1&&r!="_")){p=p+"*";r="*";}p=p.substring(0,p.length-1);if(p.length>0){var q=p.charAt(p.length-1);if(q=="."||q=="_"){p=p.substring(0,p.length-1);}}if(r=="*"){return(o.indexOf(p)==0);}else{if(r=="+"){return p<=o;}}return false;}function e(){var o="//java.com/js/webstart.png";try{return document.location.protocol.indexOf("http")!=-1?o:"http:"+o;}catch(p){return"http:"+o;}}function n(p){var o="http://java.com/dt-redirect";if(p==null||p.length==0){return o;}if(p.charAt(0)=="&"){p=p.substring(1,p.length);}return o+"?"+p;}function j(q,p){var o=q.length;for(var r=0;r<o;r++){if(q[r]===p){return true;}}return false;}function c(o){return j(m,o.toLowerCase());}function i(o){return j(b,o.toLowerCase());}function a(o){if("MSIE"!=deployJava.browserName){return true;}if(deployJava.compareVersionToPattern(deployJava.getPlugin().version,["10","0","0"],false,true)){return true;}if(o==null){return false;}return !k("1.6.0_33+",o);}var d={debug:null,version:"20120801",firefoxJavaVersion:null,myInterval:null,preInstallJREList:null,returnPage:null,brand:null,locale:null,installType:null,EAInstallEnabled:false,EarlyAccessURL:null,oldMimeType:"application/npruntime-scriptable-plugin;DeploymentToolkit",mimeType:"application/java-deployment-toolkit",launchButtonPNG:e(),browserName:null,browserName2:null,getJREs:function(){var t=new Array();if(this.isPluginInstalled()){var r=this.getPlugin();var o=r.jvms;for(var q=0;q<o.getLength();q++){t[q]=o.get(q).version;}}else{var p=this.getBrowser();if(p=="MSIE"){if(this.testUsingActiveX("1.7.0")){t[0]="1.7.0";}else{if(this.testUsingActiveX("1.6.0")){t[0]="1.6.0";}else{if(this.testUsingActiveX("1.5.0")){t[0]="1.5.0";}else{if(this.testUsingActiveX("1.4.2")){t[0]="1.4.2";}else{if(this.testForMSVM()){t[0]="1.1";}}}}}}else{if(p=="Netscape Family"){this.getJPIVersionUsingMimeType();if(this.firefoxJavaVersion!=null){t[0]=this.firefoxJavaVersion;}else{if(this.testUsingMimeTypes("1.7")){t[0]="1.7.0";}else{if(this.testUsingMimeTypes("1.6")){t[0]="1.6.0";}else{if(this.testUsingMimeTypes("1.5")){t[0]="1.5.0";}else{if(this.testUsingMimeTypes("1.4.2")){t[0]="1.4.2";}else{if(this.browserName2=="Safari"){if(this.testUsingPluginsArray("1.7.0")){t[0]="1.7.0";}else{if(this.testUsingPluginsArray("1.6")){t[0]="1.6.0";}else{if(this.testUsingPluginsArray("1.5")){t[0]="1.5.0";}else{if(this.testUsingPluginsArray("1.4.2")){t[0]="1.4.2";}}}}}}}}}}}}}if(this.debug){for(var q=0;q<t.length;++q){g("[getJREs()] We claim to have detected Java SE "+t[q]);}}return t;},installJRE:function(r,p){var o=false;if(this.isPluginInstalled()&&this.isAutoInstallEnabled(r)){var q=false;if(this.isCallbackSupported()){q=this.getPlugin().installJRE(r,p);}else{q=this.getPlugin().installJRE(r);}if(q){this.refresh();if(this.returnPage!=null){document.location=this.returnPage;}}return q;}else{return this.installLatestJRE();}},isAutoInstallEnabled:function(o){if(!this.isPluginInstalled()){return false;}if(typeof o=="undefined"){o=null;}return a(o);},isCallbackSupported:function(){return this.isPluginInstalled()&&this.compareVersionToPattern(this.getPlugin().version,["10","2","0"],false,true);},installLatestJRE:function(q){if(this.isPluginInstalled()&&this.isAutoInstallEnabled()){var r=false;if(this.isCallbackSupported()){r=this.getPlugin().installLatestJRE(q);}else{r=this.getPlugin().installLatestJRE();}if(r){this.refresh();if(this.returnPage!=null){document.location=this.returnPage;}}return r;}else{var p=this.getBrowser();var o=navigator.platform.toLowerCase();if((this.EAInstallEnabled=="true")&&(o.indexOf("win")!=-1)&&(this.EarlyAccessURL!=null)){this.preInstallJREList=this.getJREs();if(this.returnPage!=null){this.myInterval=setInterval("deployJava.poll()",3000);}location.href=this.EarlyAccessURL;return false;}else{if(p=="MSIE"){return this.IEInstall();}else{if((p=="Netscape Family")&&(o.indexOf("win32")!=-1)){return this.FFInstall();}else{location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):""));}}return false;}}},runApplet:function(p,u,r){if(r=="undefined"||r==null){r="1.1";}var t="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var o=r.match(t);if(this.returnPage==null){this.returnPage=document.location;}if(o!=null){var q=this.getBrowser();if(q!="?"){if(this.versionCheck(r+"+")){this.writeAppletTag(p,u);}else{if(this.installJRE(r+"+")){this.refresh();location.href=document.location;this.writeAppletTag(p,u);}}}else{this.writeAppletTag(p,u);}}else{g("[runApplet()] Invalid minimumVersion argument to runApplet():"+r);}},writeAppletTag:function(r,w){var o="<"+"applet ";var q="";var t="<"+"/"+"applet"+">";var x=true;if(null==w||typeof w!="object"){w=new Object();}for(var p in r){if(!c(p)){w[p]=r[p];}else{o+=(" "+p+'="'+r[p]+'"');if(p=="code"){x=false;}}}var v=false;for(var u in w){if(u=="codebase_lookup"){v=true;}if(u=="object"||u=="java_object"||u=="java_code"){x=false;}q+='<param name="'+u+'" value="'+w[u]+'"/>';}if(!v){q+='<param name="codebase_lookup" value="false"/>';}if(x){o+=(' code="dummy"');}o+=">";document.write(o+"\n"+q+"\n"+t);},versionCheck:function(p){var v=0;var x="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?(\\*|\\+)?$";var y=p.match(x);if(y!=null){var r=false;var u=false;var q=new Array();for(var t=1;t<y.length;++t){if((typeof y[t]=="string")&&(y[t]!="")){q[v]=y[t];v++;}}if(q[q.length-1]=="+"){u=true;r=false;q.length--;}else{if(q[q.length-1]=="*"){u=false;r=true;q.length--;}else{if(q.length<4){u=false;r=true;}}}var w=this.getJREs();for(var t=0;t<w.length;++t){if(this.compareVersionToPattern(w[t],q,r,u)){return true;}}return false;}else{var o="Invalid versionPattern passed to versionCheck: "+p;g("[versionCheck()] "+o);alert(o);return false;}},isWebStartInstalled:function(r){var q=this.getBrowser();if(q=="?"){return true;}if(r=="undefined"||r==null){r="1.4.2";}var p=false;var t="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var o=r.match(t);if(o!=null){p=this.versionCheck(r+"+");}else{g("[isWebStartInstaller()] Invalid minimumVersion argument to isWebStartInstalled(): "+r);p=this.versionCheck("1.4.2+");}return p;},getJPIVersionUsingMimeType:function(){for(var p=0;p<navigator.mimeTypes.length;++p){var q=navigator.mimeTypes[p].type;var o=q.match(/^application\/x-java-applet;jpi-version=(.*)$/);if(o!=null){this.firefoxJavaVersion=o[1];if("Opera"!=this.browserName2){break;}}}},launchWebStartApplication:function(r){var o=navigator.userAgent.toLowerCase();this.getJPIVersionUsingMimeType();if(this.isWebStartInstalled("1.7.0")==false){if((this.installJRE("1.7.0+")==false)||((this.isWebStartInstalled("1.7.0")==false))){return false;}}var u=null;if(document.documentURI){u=document.documentURI;}if(u==null){u=document.URL;}var p=this.getBrowser();var q;if(p=="MSIE"){q="<"+'object classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" '+'width="0" height="0">'+"<"+'PARAM name="launchjnlp" value="'+r+'"'+">"+"<"+'PARAM name="docbase" value="'+u+'"'+">"+"<"+"/"+"object"+">";}else{if(p=="Netscape Family"){q="<"+'embed type="application/x-java-applet;jpi-version='+this.firefoxJavaVersion+'" '+'width="0" height="0" '+'launchjnlp="'+r+'"'+'docbase="'+u+'"'+" />";}}if(document.body=="undefined"||document.body==null){document.write(q);document.location=u;}else{var t=document.createElement("div");t.id="div1";t.style.position="relative";t.style.left="-10000px";t.style.margin="0px auto";t.className="dynamicDiv";t.innerHTML=q;document.body.appendChild(t);}},createWebStartLaunchButtonEx:function(q,p){if(this.returnPage==null){this.returnPage=q;}var o="javascript:deployJava.launchWebStartApplication('"+q+"');";document.write("<"+'a href="'+o+"\" onMouseOver=\"window.status=''; "+'return true;"><'+"img "+'src="'+this.launchButtonPNG+'" '+'border="0" /><'+"/"+"a"+">");},createWebStartLaunchButton:function(q,p){if(this.returnPage==null){this.returnPage=q;}var o="javascript:"+"if (!deployJava.isWebStartInstalled(&quot;"+p+"&quot;)) {"+"if (deployJava.installLatestJRE()) {"+"if (deployJava.launch(&quot;"+q+"&quot;)) {}"+"}"+"} else {"+"if (deployJava.launch(&quot;"+q+"&quot;)) {}"+"}";document.write("<"+'a href="'+o+"\" onMouseOver=\"window.status=''; "+'return true;"><'+"img "+'src="'+this.launchButtonPNG+'" '+'border="0" /><'+"/"+"a"+">");},launch:function(o){document.location=o;return true;},isPluginInstalled:function(){var o=this.getPlugin();if(o&&o.jvms){return true;}else{return false;}},isAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().isAutoUpdateEnabled();}return false;},setAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().setAutoUpdateEnabled();}return false;},setInstallerType:function(o){this.installType=o;if(this.isPluginInstalled()){return this.getPlugin().setInstallerType(o);}return false;},setAdditionalPackages:function(o){if(this.isPluginInstalled()){return this.getPlugin().setAdditionalPackages(o);}return false;},setEarlyAccess:function(o){this.EAInstallEnabled=o;},isPlugin2:function(){if(this.isPluginInstalled()){if(this.versionCheck("1.6.0_10+")){try{return this.getPlugin().isPlugin2();}catch(o){}}}return false;},allowPlugin:function(){this.getBrowser();var o=("Safari"!=this.browserName2&&"Opera"!=this.browserName2);return o;},getPlugin:function(){this.refresh();var o=null;if(this.allowPlugin()){o=document.getElementById("deployJavaPlugin");}return o;},compareVersionToPattern:function(v,p,r,t){if(v==undefined||p==undefined){return false;}var w="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var x=v.match(w);if(x!=null){var u=0;var y=new Array();for(var q=1;q<x.length;++q){if((typeof x[q]=="string")&&(x[q]!="")){y[u]=x[q];u++;}}var o=Math.min(y.length,p.length);if(t){for(var q=0;q<o;++q){if(y[q]<p[q]){return false;}else{if(y[q]>p[q]){return true;}}}return true;}else{for(var q=0;q<o;++q){if(y[q]!=p[q]){return false;}}if(r){return true;}else{return(y.length==p.length);}}}else{return false;}},getBrowser:function(){if(this.browserName==null){var o=navigator.userAgent.toLowerCase();g("[getBrowser()] navigator.userAgent.toLowerCase() -> "+o);if((o.indexOf("msie")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="MSIE";this.browserName2="MSIE";}else{if(o.indexOf("trident")!=-1||o.indexOf("Trident")!=-1){this.browserName="MSIE";this.browserName2="MSIE";}else{if(o.indexOf("iphone")!=-1){this.browserName="Netscape Family";this.browserName2="iPhone";}else{if((o.indexOf("firefox")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="Netscape Family";this.browserName2="Firefox";}else{if(o.indexOf("chrome")!=-1){this.browserName="Netscape Family";this.browserName2="Chrome";}else{if(o.indexOf("safari")!=-1){this.browserName="Netscape Family";this.browserName2="Safari";}else{if((o.indexOf("mozilla")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="Netscape Family";this.browserName2="Other";}else{if(o.indexOf("opera")!=-1){this.browserName="Netscape Family";this.browserName2="Opera";}else{this.browserName="?";this.browserName2="unknown";}}}}}}}}g("[getBrowser()] Detected browser name:"+this.browserName+", "+this.browserName2);}return this.browserName;},testUsingActiveX:function(o){var q="JavaWebStart.isInstalled."+o+".0";if(typeof ActiveXObject=="undefined"||!ActiveXObject){g("[testUsingActiveX()] Browser claims to be IE, but no ActiveXObject object?");return false;}try{return(new ActiveXObject(q)!=null);}catch(p){return false;}},testForMSVM:function(){var p="{08B0E5C0-4FCB-11CF-AAA5-00401C608500}";if(typeof oClientCaps!="undefined"){var o=oClientCaps.getComponentVersion(p,"ComponentID");if((o=="")||(o=="5,0,5000,0")){return false;}else{return true;}}else{return false;}},testUsingMimeTypes:function(p){if(!navigator.mimeTypes){g("[testUsingMimeTypes()] Browser claims to be Netscape family, but no mimeTypes[] array?");return false;}for(var q=0;q<navigator.mimeTypes.length;++q){s=navigator.mimeTypes[q].type;var o=s.match(/^application\/x-java-applet\x3Bversion=(1\.8|1\.7|1\.6|1\.5|1\.4\.2)$/);if(o!=null){if(this.compareVersions(o[1],p)){return true;}}}return false;},testUsingPluginsArray:function(p){if((!navigator.plugins)||(!navigator.plugins.length)){return false;}var o=navigator.platform.toLowerCase();for(var q=0;q<navigator.plugins.length;++q){s=navigator.plugins[q].description;if(s.search(/^Java Switchable Plug-in (Cocoa)/)!=-1){if(this.compareVersions("1.5.0",p)){return true;}}else{if(s.search(/^Java/)!=-1){if(o.indexOf("win")!=-1){if(this.compareVersions("1.5.0",p)||this.compareVersions("1.6.0",p)){return true;}}}}}if(this.compareVersions("1.5.0",p)){return true;}return false;},IEInstall:function(){location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):""));return false;},done:function(p,o){},FFInstall:function(){location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"")+((this.installType!=null)?("&type="+this.installType):""));return false;},compareVersions:function(r,t){var p=r.split(".");var o=t.split(".");for(var q=0;q<p.length;++q){p[q]=Number(p[q]);}for(var q=0;q<o.length;++q){o[q]=Number(o[q]);}if(p.length==2){p[2]=0;}if(p[0]>o[0]){return true;}if(p[0]<o[0]){return false;}if(p[1]>o[1]){return true;}if(p[1]<o[1]){return false;}if(p[2]>o[2]){return true;}if(p[2]<o[2]){return false;}return true;},enableAlerts:function(){this.browserName=null;this.debug=true;},poll:function(){this.refresh();var o=this.getJREs();if((this.preInstallJREList.length==0)&&(o.length!=0)){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage;}}if((this.preInstallJREList.length!=0)&&(o.length!=0)&&(this.preInstallJREList[0]!=o[0])){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage;}}},writePluginTag:function(){var o=this.getBrowser();if(o=="MSIE"){document.write("<"+'object classid="clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA" '+'id="deployJavaPlugin" width="0" height="0">'+"<"+"/"+"object"+">");}else{if(o=="Netscape Family"&&this.allowPlugin()){this.writeEmbedTag();}}},refresh:function(){navigator.plugins.refresh(false);var o=this.getBrowser();if(o=="Netscape Family"&&this.allowPlugin()){var p=document.getElementById("deployJavaPlugin");if(p==null){this.writeEmbedTag();}}},writeEmbedTag:function(){var o=false;if(navigator.mimeTypes!=null){for(var p=0;p<navigator.mimeTypes.length;p++){if(navigator.mimeTypes[p].type==this.mimeType){if(navigator.mimeTypes[p].enabledPlugin){document.write("<"+'embed id="deployJavaPlugin" type="'+this.mimeType+'" hidden="true" />');o=true;}}}if(!o){for(var p=0;p<navigator.mimeTypes.length;p++){if(navigator.mimeTypes[p].type==this.oldMimeType){if(navigator.mimeTypes[p].enabledPlugin){document.write("<"+'embed id="deployJavaPlugin" type="'+this.oldMimeType+'" hidden="true" />');}}}}}}};d.writePluginTag();if(d.locale==null){var h=null;if(h==null){try{h=navigator.userLanguage;}catch(f){}}if(h==null){try{h=navigator.systemLanguage;}catch(f){}}if(h==null){try{h=navigator.language;}catch(f){}}if(h!=null){h.replace("-","_");d.locale=h;}}return d;}();
/*!
 * Bowser - a browser detector
 * https://github.com/ded/bowser
 * MIT License | (c) Dustin Diaz 2015
 */
!function(e,t){typeof module!="undefined"&&module.exports?module.exports=t():typeof define=="function"&&define.amd?define(t):this[e]=t();}("bowser",function(){function t(t){function n(e){var n=t.match(e);return n&&n.length>1&&n[1]||"";}function r(e){var n=t.match(e);return n&&n.length>1&&n[2]||"";}var i=n(/(ipod|iphone|ipad)/i).toLowerCase(),s=/like android/i.test(t),o=!s&&/android/i.test(t),u=/CrOS/.test(t),a=n(/edge\/(\d+(\.\d+)?)/i),f=n(/version\/(\d+(\.\d+)?)/i),l=/tablet/i.test(t),c=!l&&/[^-]mobi/i.test(t),h;/opera|opr/i.test(t)?h={name:"Opera",opera:e,version:f||n(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(t)?h={name:"Yandex Browser",yandexbrowser:e,version:f||n(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/windows phone/i.test(t)?(h={name:"Windows Phone",windowsphone:e},a?(h.msedge=e,h.version=a):(h.msie=e,h.version=n(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?h={name:"Internet Explorer",msie:e,version:n(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:u?h={name:"Chrome",chromeBook:e,chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(t)?h={name:"Microsoft Edge",msedge:e,version:a}:/chrome|crios|crmo/i.test(t)?h={name:"Chrome",chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:i?(h={name:i=="iphone"?"iPhone":i=="ipad"?"iPad":"iPod"},f&&(h.version=f)):/sailfish/i.test(t)?h={name:"Sailfish",sailfish:e,version:n(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?h={name:"SeaMonkey",seamonkey:e,version:n(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel/i.test(t)?(h={name:"Firefox",firefox:e,version:n(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(h.firefoxos=e)):/silk/i.test(t)?h={name:"Amazon Silk",silk:e,version:n(/silk\/(\d+(\.\d+)?)/i)}:o?h={name:"Android",version:f}:/phantom/i.test(t)?h={name:"PhantomJS",phantom:e,version:n(/phantomjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?h={name:"BlackBerry",blackberry:e,version:f||n(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:/(web|hpw)os/i.test(t)?(h={name:"WebOS",webos:e,version:f||n(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(h.touchpad=e)):/bada/i.test(t)?h={name:"Bada",bada:e,version:n(/dolfin\/(\d+(\.\d+)?)/i)}:/tizen/i.test(t)?h={name:"Tizen",tizen:e,version:n(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||f}:/safari/i.test(t)?h={name:"Safari",safari:e,version:f}:h={name:n(/^(.*)\/(.*) /),version:r(/^(.*)\/(.*) /)},!h.msedge&&/(apple)?webkit/i.test(t)?(h.name=h.name||"Webkit",h.webkit=e,!h.version&&f&&(h.version=f)):!h.opera&&/gecko\//i.test(t)&&(h.name=h.name||"Gecko",h.gecko=e,h.version=h.version||n(/gecko\/(\d+(\.\d+)?)/i)),!h.msedge&&(o||h.silk)?h.android=e:i&&(h[i]=e,h.ios=e);var p="";h.windowsphone?p=n(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):i?(p=n(/os (\d+([_\s]\d+)*) like mac os x/i),p=p.replace(/[_\s]/g,".")):o?p=n(/android[ \/-](\d+(\.\d+)*)/i):h.webos?p=n(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):h.blackberry?p=n(/rim\stablet\sos\s(\d+(\.\d+)*)/i):h.bada?p=n(/bada\/(\d+(\.\d+)*)/i):h.tizen&&(p=n(/tizen[\/\s](\d+(\.\d+)*)/i)),p&&(h.osversion=p);var d=p.split(".")[0];if(l||i=="ipad"||o&&(d==3||d==4&&!c)||h.silk){h.tablet=e;}else{if(c||i=="iphone"||i=="ipod"||o||h.blackberry||h.webos||h.bada){h.mobile=e;}}return h.msedge||h.msie&&h.version>=10||h.yandexbrowser&&h.version>=15||h.chrome&&h.version>=20||h.firefox&&h.version>=20||h.safari&&h.version>=6||h.opera&&h.version>=10||h.ios&&h.osversion&&h.osversion.split(".")[0]>=6||h.blackberry&&h.version>=10.1?h.a=e:h.msie&&h.version<10||h.chrome&&h.version<20||h.firefox&&h.version<20||h.safari&&h.version<6||h.opera&&h.version<10||h.ios&&h.osversion&&h.osversion.split(".")[0]<6?h.c=e:h.x=e,h;}var e=!0,n=t(typeof navigator!="undefined"?navigator.userAgent:"");return n.test=function(e){for(var t=0;t<e.length;++t){var r=e[t];if(typeof r=="string"&&r in n){return !0;}}return !1;},n._detect=t,n;});function isSecure(){return"https:"==document.location.protocol;}function hasWebSocketSupport(){var isSupported=(("WebSocket" in window&&window.WebSocket!=undefined)||("MozWebSocket" in window));return isSupported;}function createWebSocket(wsUrl,onOpenFunc,onCloseFunc,onMesgFunc,onErrorFunc){var websocket;if("WebSocket" in window){websocket=new WebSocket(wsUrl);}else{if("MozWebSocket" in window){websocket=new MozWebSocket(wsUrl);}else{return undefined;}}if(typeof onOpenFunc==="function"){websocket.onopen=function(event){onOpenFunc(websocket,event);};}else{logToConsole("No onOpenFunc specified for "+wsUrl);websocket.onopen=function(event){logToConsole("WebSocket ["+websocket.url+"] opens.");};}if(typeof onCloseFunc==="function"){websocket.onclose=function(event){onCloseFunc(websocket,event);};}else{logToConsole("No onCloseFunc specified for "+wsUrl);websocket.onclose=function(event){logToConsole("WebSocket ["+websocket.url+"] closes: "+event.code+" / "+event.reason+" / clean? "+event.wasClean);};}if(typeof onMesgFunc==="function"){websocket.onmessage=function(event){onMesgFunc(websocket,event);};}else{reportError("You must specify onMesgFunc for "+wsUrl);return undefined;}if(typeof onErrorFunc==="function"){websocket.onerror=function(event){onErrorFunc(websocket,event);};}else{websocket.onerror=function(event){logToConsole("WebSocket ["+websocket.url+"] error occurs:"+JSON.stringify(event));};}return websocket;}function isWindows(){if(("navigator" in window&&window.navigator!=undefined)&&("platform" in window.navigator)){return navigator.platform.indexOf("Win")>-1;}else{return undefined;}}function doesCurrentBrowserSupportNPAPI(){if(!("version" in bowser)){alert("Invalid bowser");return false;}var versionInt=Math.floor(bowser.version);if(bowser.chrome){return versionInt<45;}else{if(bowser.firefox){return versionInt<50;}else{if(bowser.msedge){return false;}else{if(bowser.msie){return true;}else{return false;}}}}}var MIME_TYPE_BINARY="application/octet-stream";var MIME_TYPE_TEXT="text/plain";var MIME_TYPE_HTML="text/html";var MIME_TYPE_XML="text/xml";var MIME_TYPE_BMP="image/bmp";var MIME_TYPE_JPEG="image/jpeg";var MIME_TYPE_PNG="image/png";var MIME_TYPE_GIF="image/gif";var MIME_TYPE_TIFF="image/tiff";var MIME_TYPE_PDF="application/pdf";function getMimeType(format){if(format==null){return MIME_TYPE_BINARY;}if(format.toLowerCase().indexOf("bmp")>=0){return MIME_TYPE_BMP;}else{if(format.toLowerCase().indexOf("png")>=0){return MIME_TYPE_PNG;}else{if(format.toLowerCase().indexOf("jp")>=0){return MIME_TYPE_JPEG;}else{if(format.toLowerCase().indexOf("tif")>=0){return MIME_TYPE_TIFF;}else{if(format.toLowerCase().indexOf("pdf")>=0){return MIME_TYPE_PDF;}}}}}return MIME_TYPE_BINARY;}function hasJava(){var jres=deployJava.getJREs();if(undefined==jres||jres==""||((jres instanceof Array)&&jres.length==0)){return false;}return true;}function displayEnableJavaHelp(){window.open("https://java.com/en/download/help/enable_browser.xml","java-help");}function is7u45(){return deployJava.versionCheck("1.7.0_45");}function is7u45OrAbove(){return deployJava.versionCheck("1.7.0_45+");}function createDomElement(tagName,attrs){var element=document.createElement(tagName);if(attrs!=null){for(var attr in attrs){element.setAttribute(attr,attrs[attr]);}}var text=attrs!=null&&("text" in attrs)?attrs["text"]:undefined;if(text){element.appendChild(document.createTextNode(text));}return element;}function createDomElementFromModel(assocArray){var element=createDomElement(assocArray["name"],assocArray["attributes"]);if(assocArray["children"] instanceof Array){var children=assocArray["children"];for(var c=0;c<children.length;c++){element.appendChild(createDomElementFromModel(children[c]));}}return element;}function createAppletDomElement(id,codebase,archive,className,width,height){var appletModel={"name":"applet","attributes":{"id":id,"codebase":codebase,"archive":archive,"code":className,"width":width,"height":height,"style":"z-index: -999;"},"children":[{"name":"param","attributes":{"name":"permissions","value":"all-permissions"}},{"name":"param","attributes":{"name":"java_version","value":"1.6+"}},{"name":"param","attributes":{"name":"java_arguments","value":"-Xmx512m"}},{"name":"param","attributes":{"name":"separate_jvm","value":"true"}},{"name":"param","attributes":{"name":"codebase_lookup","value":"false"}},{"name":"param","attributes":{"name":"mayscript","value":"mayscript"}}]};return createDomElementFromModel(appletModel);}function setElementStyleDisplay(element,displayType){if(!element){alert("Not an element: "+element);return;}var style=element.getAttribute("style");if(style){element.setAttribute("style",style.replace(/display:\s*[^;]*/,"display: "+displayType));}else{element.setAttribute("style","display: "+displayType+";");}}function logToConsole(mesg,isError){if(window.console){var dateStr=new Date().toLocaleTimeString();if(isError){if(console.error){console.error(dateStr+" "+mesg);}else{console.log(dateStr+" "+"ERROR: "+mesg);}}else{if(console.info){console.info(dateStr+" "+mesg);}else{console.log(dateStr+""+" INFO: "+mesg);}}}else{if(isError){alert("ERROR: "+mesg);}}}function reportError(mesg){alert(mesg);}function isModernBrowser(){return typeof(atob)==="function"&&typeof(ArrayBuffer)==="function"&&typeof(Uint8Array)==="function"&&typeof(Blob)==="function"&&typeof(FormData)==="function";}function base64ToUint8Array(base64){if(!isModernBrowser()){reportError("base64ToBlob() is not supported in legacy browsers.");return null;}if(base64!=null&&base64.indexOf("data:")==0){var prefixEnd="base64,";var suffixPos=base64.indexOf(prefixEnd);if(suffixPos>0){base64=base64.substr(suffixPos+prefixEnd.length);}}base64=base64.replace(/(\r\n|\n|\r)/gm,"");var binary=atob(base64);var len=binary.length;var buffer=new ArrayBuffer(len);var view=new Uint8Array(buffer);for(var i=0;i<len;i++){view[i]=binary.charCodeAt(i);}return view;}function base64ToBlob(base64,mimeType){if(!isModernBrowser()){reportError("base64ToBlob() is not supported in legacy browsers.");return null;}if(base64!=null&&base64.indexOf("data:")==0){var semiColonPos=base64.indexOf(";");if(!mimeType&&semiColonPos>0){mimeType=base64.substring("data:".length,semiColonPos);}var prefixEnd="base64,";var suffixPos=base64.indexOf(prefixEnd);if(suffixPos>0){base64=base64.substr(suffixPos+prefixEnd.length);}}base64=base64.replace(/(\r\n|\n|\r)/gm,"");var binary=atob(base64);var len=binary.length;var buffer=new ArrayBuffer(len);var view=new Uint8Array(buffer);for(var i=0;i<len;i++){view[i]=binary.charCodeAt(i);}return new Blob([view],{type:mimeType});}var pageLoadId=Date.now()+"-"+Math.floor(Math.random()*(1000-0+1)+0);if(window.sessionStorage){if(sessionStorage.getItem("pageLoadId")){pageLoadId=sessionStorage.getItem("pageLoadId");}else{sessionStorage.setItem("pageLoadId",pageLoadId);}}function removeFragmentFromUrl(url){if(url==null){return url;}var posHash=url.indexOf("#");if(posHash>=0){return url.substr(0,posHash);}return url;}function com_asprise_scan_addInstallPromptDomElementIfNotExists(){var urlAppDownload="http://asprise.com/_dl/scanapp/scan-setup.exe";var _com_asprise_scan_prompt_id="com_asprise_scan_prompt";var elementPrompt=document.getElementById(_com_asprise_scan_prompt_id);if(elementPrompt!=null){return true;}var divPromptModel={"name":"div","attributes":{"id":"com_asprise_scan_prompt","class":"com_asprise_scan_prompt_class prompt-dialog","style":"display: none;"},"children":[{"name":"a","attributes":{"class":"top-right-closer","title":"Dismiss this dialog","onclick":"com_asprise_scan_prompt_install_display(false);"}},{"name":"h3","attributes":{"style":"margin-top: 0px;","text":"Please Enable Scanning"}},{"name":"div","attributes":{"class":"java","style":"display: none;"},"children":[{"name":"p","attributes":{"text":"In order to scan directly from your browser, you need to either enable Java or install the scan app: "}},{"name":"table","attributes":{"width":"100%"},"children":[{"name":"td","attributes":{"width":"50%","align":"center","valign":"top"},"children":[{"name":"h4","attributes":{"text":"Either Option 1:"}},{"name":"a","attributes":{"class":"icon-action icon-action-enable-java","href":"javascript:displayEnableJavaHelp();"}},{"name":"p","attributes":{"style":"vertical-align: middle; text-align: center;"},"children":[{"name":"a","attributes":{"href":"javascript:displayEnableJavaHelp();","text":"Enable Java"}},{"name":"span","attributes":{"text":"; once done, please "}},{"name":"button","attributes":{"type":"button","class":"btn btn-default btn-xs","onclick":"document.location.reload(false);","style":"","text":"Refresh Page"}}]},]},{"name":"td","attributes":{"width":"10px"}},{"name":"td","attributes":{"width":"1px","style":"background-color: #cccccc;"}},{"name":"td","attributes":{"width":"10px"}},{"name":"td","attributes":{"align":"center","valign":"top"},"children":[{"name":"h4","attributes":{"text":"Or Option 2:"}},{"name":"a","attributes":{"class":"icon-action icon-action-install-app","href":urlAppDownload,"target":"_blank"}},{"name":"p","children":[{"name":"a","attributes":{"href":urlAppDownload,"target":"_blank","text":"Download and run it"}},{"name":"span","attributes":{"text":". No need to refresh page."}}]}]}]}]},{"name":"div","attributes":{"class":"nojava","style":"display: none;"},"children":[{"name":"p","attributes":{"text":"In order to scan directly from your browser, you need to install the scan app: "}},{"name":"a","attributes":{"class":"icon-action icon-action-install-app","href":urlAppDownload,"target":"_blank"}},{"name":"p","attributes":{"style":"vertical-align: middle; text-align: center;"},"children":[{"name":"a","attributes":{"href":urlAppDownload,"target":"_blank","text":"Download and run it"}},{"name":"span","attributes":{"text":". No need to refresh page."}}]}]}]};var divOverlayModel={"name":"div","attributes":{"id":"com_asprise_scan_prompt_overlay","class":"com_asprise_scan_prompt_overlay_class overlay-for-prompt","style":"display: none;"},};var elementBodyList=document.getElementsByTagName("body");var elementBody=(elementBodyList!=null&&elementBodyList.length>0)?elementBodyList.item(0):null;if(elementBody==null){reportError("please do not execute com_asprise_scan_addInstallPromptDomElementIfNotExists in <header>!");return false;}elementBody.appendChild(createDomElementFromModel(divPromptModel));elementBody.appendChild(createDomElementFromModel(divOverlayModel));return true;}function com_asprise_scan_addScanReadyPromptDomElementIfNotExists(){var _com_asprise_scan_app_ok_id="com_asprise_scan_app_ok";var elementPrompt=document.getElementById(_com_asprise_scan_app_ok_id);if(elementPrompt!=null){return true;}var divPromptModel={"name":"div","attributes":{"id":"com_asprise_scan_app_ok","class":"com_asprise_scan_app_ok_class prompt-dialog","style":"display: none;"},"children":[{"name":"a","attributes":{"class":"top-right-closer","title":"Dismiss this dialog","onclick":"setElementStyleDisplay(document.getElementById('com_asprise_scan_app_ok'), 'none');"}},{"name":"h3","attributes":{"style":"text-align: center;"},"children":[{"name":"span","attributes":{"style":"font-size: larger; color: #00A000;","text":"✔"}},{"name":"span","attributes":{"text":" SCANNING ENABLED"}}]},{"name":"p","attributes":{"style":"vertical-align: middle; text-align: center;","text":"You may now scan directly from your browsers."}}]};var elementBodyList=document.getElementsByTagName("body");var elementBody=(elementBodyList!=null&&elementBodyList.length>0)?elementBodyList.item(0):null;if(elementBody==null){reportError("please do not execute com_asprise_scan_addScanReadyPromptDomElementIfNotExists in <header>!");return false;}elementBody.appendChild(createDomElementFromModel(divPromptModel));return true;}function com_asprise_scan_prompt_install_display(display){var _com_asprise_scan_prompt_id=(typeof com_asprise_scan_prompt_id==="undefined")?"com_asprise_scan_prompt":com_asprise_scan_prompt_id;var _com_asprise_scan_prompt_overlay_id=(typeof com_asprise_scan_prompt_overlay_id==="undefined")?"com_asprise_scan_prompt_overlay":com_asprise_scan_prompt_overlay_id;com_asprise_scan_addInstallPromptDomElementIfNotExists();var elementPrompt=document.getElementById(_com_asprise_scan_prompt_id);if(elementPrompt==null){reportError("Unable to find prompt of id: "+_com_asprise_scan_prompt_id);return false;}var browserMaySupportJava=doesCurrentBrowserSupportNPAPI();var elementsJava=elementPrompt.querySelectorAll(".java");for(var index=0;index<elementsJava.length;index++){elementsJava[index].style.display=browserMaySupportJava?"block":"none";}var elementsNoJava=elementPrompt.querySelectorAll(".nojava");for(var index=0;index<elementsNoJava.length;index++){elementsNoJava[index].style.display=browserMaySupportJava?"none":"block";}elementPrompt.style.display=display?"block":"none";var elementOverlay=document.getElementById(_com_asprise_scan_prompt_overlay_id);if(elementOverlay==null){logToConsole("Prompt overlay doesn't exist (id: "+_com_asprise_scan_prompt_overlay_id+").");}else{elementOverlay.style.display=display?"block":"none";}return true;}function com_asprise_scan_scan_ready_notify(){var _com_asprise_scan_app_ok_id=(typeof com_asprise_scan_app_ok_id==="undefined")?"com_asprise_scan_app_ok":com_asprise_scan_app_ok_id;com_asprise_scan_addScanReadyPromptDomElementIfNotExists();var elementPrompt=document.getElementById(_com_asprise_scan_app_ok_id);if(elementPrompt==null){return false;}elementPrompt.style.display="block";window.setTimeout(function(){setElementStyleDisplay(document.getElementById("com_asprise_scan_app_ok"),"none");},4*1000);return true;}function com_asprise_scan_getScannerJsBaseUrl(){var sc=document.getElementsByTagName("script");for(var idx=0;idx<sc.length;idx++){var s=sc.item(idx);if(s.src&&s.src.match(/scanner\.js(\?\w*)?$/)){var url=s.src;var base=url.substring(0,url.lastIndexOf("/")+1);return base;}}return undefined;}function com_asprise_scan_addScanAppletToDomIfNotExists(parentElement,width,height){var _com_asprise_scan_applet_info_id=(typeof com_asprise_scan_applet_info_id==="undefined")?"com_asprise_scan_applet":com_asprise_scan_applet_info_id;var _com_asprise_scan_applet_info_codebase=(typeof com_asprise_scan_applet_info_codebase==="undefined")?com_asprise_scan_getScannerJsBaseUrl():com_asprise_scan_applet_info_codebase;if(_com_asprise_scan_applet_info_codebase.indexOf("FORCE_REFRESH")>-1&&window.location.href.indexOf("FORCE_REFRESH")>-1){_com_asprise_scan_applet_info_codebase=_com_asprise_scan_applet_info_codebase.replace(/FORCE_REFRESH/g,"FORCE_REFRESH_"+(new Date()).getTime());}var _com_asprise_scan_applet_info_classname=(typeof com_asprise_scan_applet_info_classname==="undefined")?"com.asprise.imaging.scan.ui.web.ScanApplet":com_asprise_scan_applet_info_classname;var _com_asprise_scan_applet_info_jarname=(typeof com_asprise_scan_applet_info_jarname==="undefined")?"asprise_scan.jar":com_asprise_scan_applet_info_jarname;var _com_asprise_scan_applet_info_jarname_legacy=(typeof com_asprise_scan_applet_info_jarname_legacy==="undefined")?"asprise_scan-legacy.jar":com_asprise_scan_applet_info_jarname_legacy;var elementApplet=document.getElementById(_com_asprise_scan_applet_info_id);if(elementApplet!=null){return true;}elementApplet=createAppletDomElement(_com_asprise_scan_applet_info_id,_com_asprise_scan_applet_info_codebase,is7u45OrAbove()?_com_asprise_scan_applet_info_jarname:_com_asprise_scan_applet_info_jarname_legacy,_com_asprise_scan_applet_info_classname,width,height);if(parentElement==null){var elementBodyList=document.getElementsByTagName("body");var elementBody=(elementBodyList!=null&&elementBodyList.length>0)?elementBodyList.item(0):null;if(elementBody==null){reportError("please do not execute com_asprise_scan_addScanAppletToDomIfNotExists in <header>!");return false;}elementBody.appendChild(elementApplet);}else{parentElement.appendChild(elementApplet);}return true;}var scanWebSocketServerRangeLowest=(typeof com_asprise_scan_port_range_lowest==="undefined")?9713:com_asprise_scan_port_range_lowest;var scanWebSocketServerRangeHighest=(typeof com_asprise_scan_port_range_highest==="undefined")?9715:com_asprise_scan_port_range_highest;var scanWebSocketServerPort;var scanWebSocket;var scanWebSocketConnectAttemptTime;function onScanWebSocketMesg(ws,mesg){funcCallResponseFromWebSocket(true,mesg.data);}function connectedToScanWebSocket(){return scanWebSocket!=undefined;}function onScanWebSocketOpen(ws,open){scanWebSocket=ws;logToConsole("Scan WebSocket server connected: "+scanWebSocket.url);com_asprise_scan_prompt_install_display(false);com_asprise_scan_scan_ready_notify();if(!(typeof com_asprise_scan_app_license==="undefined")){ws.send("LICENSE: "+com_asprise_scan_app_license);}funcCallToWebSocket();}function onScanWebSocketClose(ws,close){scanWebSocket=undefined;connectToScanWebSocketServer();}function failedToConnectToWebSocketServer(){scanWebSocketServerPort=undefined;logToConsole("Failed to connect to WebSocket server.",true);if(!doesCurrentBrowserSupportNPAPI()){com_asprise_scan_prompt_install_display(true);}connectToScanWebSocketServer();}function connectToScanWebSocketServer(){if(!canUseWebSocketImpl()){alert("Cancelled as scan app implementation is disabled explicitly.");return;}if(scanWebSocket){scanWebSocketConnectAttemptTime=undefined;scanWebSocket.close();return;}if(scanWebSocketServerPort==undefined){scanWebSocketServerPort=scanWebSocketServerRangeLowest;}else{if(scanWebSocketConnectAttemptTime!=undefined&&(Date.now()-scanWebSocketConnectAttemptTime<10*1000)){scanWebSocketServerPort+=1;}else{}}if(scanWebSocketServerPort<scanWebSocketServerRangeLowest||scanWebSocketServerPort>scanWebSocketServerRangeHighest){failedToConnectToWebSocketServer();return;}scanWebSocketConnectAttemptTime=Date.now();createWebSocket("wss://local.scannerjs.com:"+scanWebSocketServerPort+"/"+pageLoadId+"/"+encodeURIComponent(removeFragmentFromUrl(window.location.href)),onScanWebSocketOpen,onScanWebSocketClose,onScanWebSocketMesg,undefined);}function canUseJavaAppletImpl(){return(typeof com_asprise_scan_enable_java_applet==="undefined")||com_asprise_scan_enable_java_applet;}function canUseWebSocketImpl(){return(typeof com_asprise_scan_enable_scan_app==="undefined")||com_asprise_scan_enable_scan_app;}var com_asprise_scannerjs_request_status_PENDING="PENDING";var com_asprise_scannerjs_request_status_PROCESSING="PROCESSING";var com_asprise_scannerjs_request_status_COMPLETE="COMPLETE";var com_asprise_scannerjs_form_field_name_for_images_objects="com_asprise_scannerjs_images[]";var com_asprise_scannerjs_form_field_name_for_images_urls="com_asprise_scannerjs_images_urls[]";function monitorFuncCallRequest(){if((typeof window.com_asprise_scannerjs_request_status==="undefined")||(typeof window.com_asprise_scannerjs_request_status_set==="undefined")){return;}if(window.com_asprise_scannerjs_request_status==com_asprise_scannerjs_request_status_PENDING&&(new Date().getTime()-window.com_asprise_scannerjs_request_status_set>10*1000)){com_asprise_scan_prompt_install_display(true);}}function asprise_scanner_js_call_function(callbackFunc,funcName,arg1,arg2,argsMore){if(arguments.length<2){reportError("Invalid function call - func name is not specified");return false;}if(typeof callbackFunc!=="function"){reportError("asprise_scanner_js_call_function requires a valid callbackFunc");return false;}if(window.com_asprise_scannerjs_request_status==com_asprise_scannerjs_request_status_PENDING||window.com_asprise_scannerjs_request_status==com_asprise_scannerjs_request_status_PROCESSING){reportError("You can not submit a new request as the previous request has not completed yet.");return false;}if(!com_asprise_scan_addScanAppletToDomIfNotExists(null,1,1)){reportError("Func call to "+funcName+" is cancelled as the applet has not been created successfully.");return false;}if(!JSON||typeof JSON.stringify!=="function"){reportError("JSON.stringify is not supported by your browser.");return false;}var funcCallObject={"funcName":funcName,"time":new Date().getTime(),"userAgent":navigator.userAgent,"isModernBrowser":isModernBrowser(),"windowTitle":document.title,"url":window.location.href,"pageLoadId":pageLoadId};var funcArgs=[];for(var a=2;a<arguments.length;a++){funcArgs.push(arguments[a]);}funcCallObject["funcArgs"]=funcArgs;var funcCallJsonString=JSON.stringify(funcCallObject);window.com_asprise_scannerjs_request_status=com_asprise_scannerjs_request_status_PENDING;window.com_asprise_scannerjs_request_status_set=new Date().getTime();window.com_asprise_scannerjs_request_func_call=funcCallJsonString;window.com_asprise_scannerjs_request_callback=callbackFunc;funcCallToWebSocket();return true;}function funcCallToWebSocket(){if(!connectedToScanWebSocket()){return false;}if(window.com_asprise_scannerjs_request_status!=com_asprise_scannerjs_request_status_PENDING){return true;}try{scanWebSocket.send(window.com_asprise_scannerjs_request_func_call);window.com_asprise_scannerjs_request_status=com_asprise_scannerjs_request_status_PROCESSING;window.com_asprise_scannerjs_request_status_set=new Date().getTime();return true;}catch(e){asprise_scanner_js_function_return(false,"Failed: "+e,null,null,null,null);logToConsole(e,true);return false;}}function funcCallResponseFromWebSocket(successful,response){if(successful){var returned=null;try{returned=JSON.parse(response);}catch(e){reportError("Failed to parse JSON: "+response);asprise_scanner_js_function_return(false,"Failed to parse JSON: "+response,null,null,null,null);return;}if(returned instanceof Array){asprise_scanner_js_function_return(returned[0],returned[1],returned[2],returned[3],returned[4],returned[5]);}else{asprise_scanner_js_function_return(false,"JSON returned from WebSocket is not array",null,null,null,null);}}else{asprise_scanner_js_function_return(false,"Failed due to WebSocket error",null,null,null,null);}}function asprise_scanner_js_function_return(successful,mesg,log,callbackFuncName,argCount,args){window.com_asprise_scannerjs_request_status=com_asprise_scannerjs_request_status_COMPLETE;window.com_asprise_scannerjs_request_status_set=new Date().getTime();window.com_asprise_scannerjs_request_callback(successful,mesg,args);}function asprise_scanner_js_scan(callbackFunc,requestSpecObject,useAspriseDialog,showScannerUI){if((typeof requestSpecObject!=="string")&&(!JSON||typeof JSON.stringify!=="function")){reportError("JSON.stringify is not supported by your browser.");return false;}var requestSpecInString=(typeof requestSpecObject==="string")?requestSpecObject:JSON.stringify(requestSpecObject);return asprise_scanner_js_call_function(callbackFunc,"scan",requestSpecInString,arguments.length>=3?useAspriseDialog:null,arguments.length>=4?showScannerUI:null);}function asprise_scanner_js_submit_form_with_images(formId,images,onReadyStateChangeHandler){if((!(images instanceof Array))||images.length==0){alert("no images - form submit cancelled.");return undefined;}for(var i=0;i<images.length;i++){var image=images[i];if(!(image instanceof ScannedImage)){logToConsole("Invalid image object: "+image,true);alert("Invalid image object!");return undefined;}}var formElement=document.getElementById(formId);if(formElement==null){alert("Form doesn't exist: "+formId);return undefined;}var fd=new FormData(formElement);for(var i=0;i<images.length;i++){var image=images[i];if(image.srcIsBase64){fd.append(com_asprise_scannerjs_form_field_name_for_images_objects,base64ToBlob(image.src,image.mimeType));}else{fd.append(com_asprise_scannerjs_form_field_name_for_images_urls,image.src);}}logToConsole("POST images, count: "+images.length);var xhr=new XMLHttpRequest();xhr.open("POST",formElement.getAttribute("action"),true);xhr.onreadystatechange=function(){if(typeof(onReadyStateChangeHandler)=="function"){onReadyStateChangeHandler(xhr);}};xhr.send(fd);logToConsole("Form posted: "+xhr);return xhr;}var ScannedImage=function(mimeType,srcIsBase64,src,imageInfo){this.mimeType=mimeType;this.srcIsBase64=srcIsBase64;this.src=src;this.imageInfo=imageInfo;};ScannedImage.prototype.getWidth=function(){return(typeof this.imageInfo==="object")?this.imageInfo.ImageWidth:undefined;};ScannedImage.prototype.getHeight=function(){return(typeof this.imageInfo==="object")?this.imageInfo.ImageLength:undefined;};ScannedImage.prototype.getBitsPerPixel=function(){return(typeof this.imageInfo==="object")?this.imageInfo.BitsPerPixel:undefined;};ScannedImage.prototype.isColor=function(){return(typeof this.imageInfo==="object")?this.imageInfo.PixelType==2:undefined;};ScannedImage.prototype.isGray=function(){return(typeof this.imageInfo==="object")?this.imageInfo.PixelType==1:undefined;};ScannedImage.prototype.isBlackWhite=function(){return(typeof this.imageInfo==="object")?this.imageInfo.PixelType==0:undefined;};ScannedImage.prototype.getResolution=function(){return(typeof this.imageInfo==="object")?Math.floor(this.imageInfo.XResolution):undefined;};ScannedImage.prototype.getBase64NoPrefix=function(){if(!this.srcIsBase64){return undefined;}return this.srcIsBase64?base64ToBlob(src):undefined;};ScannedImage.prototype.toString=function(){var s="";if(this.isColor()){s+="Color ";}else{if(this.isGray()){s+="Gray ";}else{if(this.isBlackWhite()){s+="Black/white ";}}}s+="image:";var width=this.getWidth();var height=this.getHeight();var bits=this.getBitsPerPixel();var resolution=this.getResolution();if(width>0&&height>0){s+=" "+width+" x "+height;}if(bits>0){s+=" "+bits+"-bit";}if(resolution>0){s+" @ "+resolution+" DPI";}return s;};function getScannedImages(response,includeOriginals,includeThumbnails){var images=[];if(arguments.length<2){includeOriginals=true;}if(arguments.length<3){includeThumbnails=false;}if(!includeOriginals&&!includeThumbnails){reportError("getImages: will return no image as neither includeOriginals nor includeThumbnails is true.");return images;}if(typeof response==="string"){response=JSON.parse(response);}if(typeof response==="object"&&response.output instanceof Array){var outputs=response.output;for(var o=0;o<outputs.length;o++){var output=outputs[o];if((includeOriginals&&output.type=="return-base64")||(includeThumbnails&&output.type=="return-base64-thumbnail")){var mimeType=getMimeType(output.format);if(mimeType==MIME_TYPE_BINARY){logToConsole("Unable to find mime type for "+output.format);continue;}if(!(output.result instanceof Array)){logToConsole("Output contains no result records",true);continue;}for(var r=0;r<output.result.length;r++){var imgInfo=(response.images instanceof Array)&&r<response.images.length?response.images[r].image_info:undefined;images.push(new ScannedImage(mimeType,true,"data:"+mimeType+";base64,"+output.result[r],imgInfo));}}else{}}}return images;}function getUploadResponse(response){logToConsole(response);if(typeof response==="string"){response=JSON.parse(response);}if(typeof response==="object"&&response.output instanceof Array){var outputs=response.output;for(var o=0;o<outputs.length;o++){var output=outputs[o];if(output.type=="upload"||output.type=="upload-thumbnail"){if((output.result instanceof Array)&&output.result.length>0){return output.result[0];}}}}return undefined;}function getSaveResponse(response){logToConsole(response);if(typeof response==="string"){response=JSON.parse(response);}if(typeof response==="object"&&response.output instanceof Array){var outputs=response.output;for(var o=0;o<outputs.length;o++){var output=outputs[o];if(output.type=="save"||output.type=="save-thumbnail"){return JSON.stringify(output.result);}}}return undefined;}function insertCss(code){var style=document.createElement("style");style.type="text/css";if(style.styleSheet){style.styleSheet.cssText=code;}else{style.innerHTML=code;}document.getElementsByTagName("head")[0].appendChild(style);}function loadCssFile(url){var fileref=document.createElement("link");fileref.setAttribute("rel","stylesheet");fileref.setAttribute("type","text/css");fileref.setAttribute("href",url);document.getElementsByTagName("head")[0].appendChild(fileref);}function loadScannerCssIfNotPresent(){var presents=false;var sc=document.getElementsByTagName("link");for(var idx=0;idx<sc.length;idx++){var s=sc.item(idx);if(s.href&&s.href.match(/scannerjs\.css(\?\w*)?$/)){presents=true;}}if(!presents){loadCssFile(com_asprise_scan_getScannerJsBaseUrl()+"scannerjs.css");}}window.addEventListener("load",function(){loadScannerCssIfNotPresent();if(canUseWebSocketImpl()){if(!hasJava()){window.setTimeout(connectToScanWebSocketServer,200);}}window.setInterval(monitorFuncCallRequest,8000);});